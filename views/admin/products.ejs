<%- include('../partials/header') %>

<div
	style="
		display: flex;
		justify-content: space-between;
		align-items: center;
		margin-bottom: 2rem;
	"
>
	<h1 style="font-size: 2rem; font-weight: 700">Gestión de Productos</h1>
	<a href="/admin" class="btn" style="background: var(--bg-accent)"
		><i class="fa-solid fa-arrow-left"></i> Volver</a
	>
</div>

<div style="display: grid; grid-template-columns: 1fr 2fr; gap: 2rem">
	<!-- Add Product Form -->
	<div class="glass-card">
		<h3 style="margin-bottom: 1.5rem">Nuevo Producto</h3>
		<form action="/admin/products" method="POST">
			<div class="form-group">
				<label class="form-label">Nombre</label>
				<input type="text" name="name" class="form-control" required />
			</div>
			<div class="form-group">
				<label class="form-label">SKU (Código)</label>
				<input type="text" name="sku" class="form-control" required />
			</div>
			<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem">
				<div class="form-group">
					<label class="form-label">Precio</label>
					<input
						type="number"
						step="0.01"
						name="price"
						class="form-control"
						required
					/>
				</div>
				<div class="form-group">
					<label class="form-label">Stock Actual</label>
					<input type="number" name="stock" class="form-control" required />
				</div>
			</div>
			<div class="form-group">
				<label class="form-label">Categoría</label>
				<input type="text" name="category" class="form-control" />
			</div>
			<div class="form-group">
				<label class="form-label">Stock Mínimo</label>
				<input type="number" name="min_stock" class="form-control" value="5" />
			</div>
			<button type="submit" class="btn btn-primary" style="width: 100%">
				Agregar Producto
			</button>
		</form>
	</div>

	<!-- Product List -->
	<div class="glass-card">
		<h3 style="margin-bottom: 1.5rem">Inventario</h3>
		<div style="overflow-x: auto">
			<table style="width: 100%; border-collapse: collapse; min-width: 600px">
				<thead>
					<tr
						style="
							text-align: left;
							border-bottom: 1px solid var(--border-color);
						"
					>
						<th style="padding: 1rem">SKU</th>
						<th style="padding: 1rem">Producto</th>
						<th style="padding: 1rem">Precio</th>
						<th style="padding: 1rem">Stock</th>
						<th style="padding: 1rem">Acciones</th>
					</tr>
				</thead>
				<tbody>
					<% if (products && products.length > 0) { %> <%
					products.forEach(product => { %>
					<tr style="border-bottom: 1px solid var(--glass-border)">
						<td style="padding: 1rem; color: var(--text-secondary)">
							<%= product.sku %>
						</td>
						<td style="padding: 1rem; font-weight: 500"><%= product.name %></td>
						<td style="padding: 1rem; color: var(--success)">
							$<%= product.price %>
						</td>
						<td style="padding: 1rem">
							<span
								style="padding: 0.25rem 0.5rem; border-radius: 99px; font-size: 0.875rem; background: <%= product.stock <= product.min_stock ? 'rgba(239, 68, 68, 0.2)' : 'rgba(34, 197, 94, 0.2)' %>; color: <%= product.stock <= product.min_stock ? '#fca5a5' : '#86efac' %>;"
							>
								<%= product.stock %>
							</span>
						</td>
						<td style="padding: 1rem">
							<form
								action="/admin/products/delete/<%= product.id %>"
								method="POST"
								style="display: inline"
								onsubmit="return confirm('¿Eliminar producto?');"
							>
								<button
									type="submit"
									class="btn"
									style="
										padding: 0.5rem;
										background: none;
										color: var(--danger);
									"
								>
									<i class="fa-solid fa-trash"></i>
								</button>
							</form>
						</td>
					</tr>
					<% }) %> <% } else { %>
					<tr>
						<td
							colspan="5"
							style="
								padding: 1rem;
								text-align: center;
								color: var(--text-secondary);
							"
						>
							No hay productos registrados.
						</td>
					</tr>
					<% } %>
				</tbody>
			</table>
		</div>
	</div>
</div>

<%- include('../partials/footer') %>
